```<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
        />
        <title>CETÂõõÂÖ≠Á∫ßÊâìÂç°Êó•ÂéÜ</title>
        <style>
            :root {
                --primary-color: #6c5ce7;
                --success-color: #00b894;
                --reward-color: #fdcb6e;
                --sys-reward-color: #ff7675;
                --bg-color: #f8f9fa;
                --text-main: #2d3436;
                --text-sub: #636e72;
            }

            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    sans-serif;
                background-color: var(--bg-color);
                margin: 0;
                padding: 10px;
                display: flex;
                flex-direction: column;
                align-items: center;
                color: var(--text-main);
            }

            .nav-header {
                text-align: center;
                margin-bottom: 10px;
            }
            .nav-link {
                color: var(--primary-color);
                text-decoration: none;
                font-weight: bold;
                font-size: 14px;
            }

            .search-bar {
                display: flex;
                width: 100%;
                max-width: 400px;
                gap: 8px;
                margin-bottom: 15px;
            }
            .search-input {
                flex: 1;
                padding: 8px 12px;
                border: 1px solid #ddd;
                border-radius: 20px;
                outline: none;
                font-size: 14px;
            }

            .container {
                width: 100%;
                max-width: 800px;
                background: white;
                border-radius: 20px;
                padding: 12px;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
                box-sizing: border-box;
            }

            .calendar-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
            }
            .month-title {
                font-size: 18px;
                font-weight: bold;
                color: var(--primary-color);
            }

            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 4px;
            }

            .weekday {
                text-align: center;
                font-size: 11px;
                font-weight: bold;
                color: var(--text-sub);
                padding-bottom: 8px;
            }

            .day {
                min-height: 105px;
                background: #fff;
                border: 1px solid #edf2f7;
                border-radius: 10px;
                padding: 4px;
                display: flex;
                flex-direction: column;
                align-items: center;
                position: relative;
                cursor: pointer;
                box-sizing: border-box;
            }
            .day.today {
                border: 2px solid var(--primary-color);
                background: #f0f7ff;
            }
            .day.checked-in {
                background-color: #e6fffb;
            }
            .day.other-month {
                opacity: 0.15;
                pointer-events: none;
            }

            .day-header {
                width: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                margin-bottom: 4px;
                line-height: 1.2;
            }
            .day-num {
                font-size: 11px;
                font-weight: bold;
                color: var(--text-main);
            }
            .lunar {
                color: #a4b0be;
                font-weight: normal;
                font-size: 8px;
            }

            .day-img {
                width: 40px;
                height: 40px;
                object-fit: cover;
                border-radius: 6px;
                margin-bottom: 4px;
                border: 1px solid #eee;
            }

            .word-wrap {
                text-align: center;
                width: 100%;
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            .en-word {
                font-size: 11px;
                font-weight: 800;
                color: var(--primary-color);
                line-height: 1;
                word-break: break-all;
                margin-bottom: 2px;
            }
            .cn-word {
                font-size: 9px;
                color: var(--text-sub);
                transform: scale(0.9);
            }

            .audio-btn {
                background: none;
                border: none;
                color: var(--primary-color);
                font-size: 10px;
                padding: 2px;
            }

            .badge-reward,
            .badge-sys {
                position: absolute;
                bottom: 2px;
                font-size: 12px;
                z-index: 5;
            }
            .badge-reward {
                right: 2px;
            }
            .badge-sys {
                right: 18px;
            }
            .sys-tag {
                position: absolute;
                top: 0;
                left: 0;
                background: var(--sys-reward-color);
                color: white;
                font-size: 7px;
                padding: 1px 3px;
                border-bottom-right-radius: 5px;
            }
            .check-mark {
                position: absolute;
                top: 2px;
                right: 5px;
                color: var(--success-color);
                font-size: 10px;
                font-weight: bold;
            }

            .btn {
                border: none;
                border-radius: 8px;
                padding: 6px 12px;
                font-weight: bold;
                cursor: pointer;
                font-size: 13px;
            }
            .btn-primary {
                background: var(--primary-color);
                color: white;
            }
            .btn-gray {
                background: #eee;
                color: #333;
            }

            .info-panel {
                margin-top: 15px;
                padding: 12px;
                background: #fffbe6;
                border-radius: 12px;
                font-size: 12px;
                color: #856404;
            }

            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                backdrop-filter: blur(4px);
                z-index: 1000;
                justify-content: center;
                align-items: center;
            }
            .modal-content {
                background: white;
                padding: 25px;
                border-radius: 20px;
                width: 85%;
                max-width: 320px;
                text-align: center;
                box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            }
            .modal-content input {
                width: 100%;
                padding: 12px;
                margin: 10px 0;
                border: 1px solid #ddd;
                border-radius: 8px;
                box-sizing: border-box;
                font-size: 16px;
            }
            .btn-row {
                display: flex;
                gap: 10px;
                margin-top: 15px;
            }
            .btn-row button {
                flex: 1;
            }

            @media (max-width: 400px) {
                .day {
                    min-height: 90px;
                }
                .day-img {
                    width: 30px;
                    height: 30px;
                }
                .en-word {
                    font-size: 9px;
                }
            }
        </style>
    </head>
    <body>
        <div class="nav-header">
            <a href="index.html" class="nav-link">üéâ ÂàáÊç¢Âà∞ÊäΩÂ•ñÁ≥ªÁªü</a>
        </div>

        <div class="search-bar">
            <input
                type="text"
                id="global-input"
                class="search-input"
                placeholder="ÂçïËØçÊúóËØª..."
            />
            <button
                class="btn btn-primary"
                onclick="speak(document.getElementById('global-input').value)"
            >
                ÊúóËØª
            </button>
        </div>

        <div class="container">
            <div class="calendar-header">
                <div>
                    <button class="btn btn-gray" onclick="changeMonth(-1)">
                        ‰∏äÊúà
                    </button>
                    <button
                        class="btn btn-primary"
                        style="background: #a29bfe"
                        onclick="openAdmin('sys_config')"
                    >
                        ËÆæÁΩÆ
                    </button>
                </div>
                <div class="month-title" id="month-display"></div>
                <button class="btn btn-gray" onclick="changeMonth(1)">
                    ‰∏ãÊúà
                </button>
            </div>

            <div class="calendar-grid" id="calendar-grid">
                <div class="weekday">Êó•</div>
                <div class="weekday">‰∏Ä</div>
                <div class="weekday">‰∫å</div>
                <div class="weekday">‰∏â</div>
                <div class="weekday">Âõõ</div>
                <div class="weekday">‰∫î</div>
                <div class="weekday">ÂÖ≠</div>
            </div>

            <div class="info-panel">
                <b>üí° ÊèêÁ§∫Ôºö</b>
                ÂçïÂáªÁ≠æÂà∞/ÊúóËØªÔºõÂèåÂáªÂõæËÆæÂ•ñÔºõÂèåÂáªÁ©∫ÁôΩÈáçÁΩÆÔºõÈò¥ÂéÜ‰∏≠ÊñáÊòæÁ§∫ÔºåÂçïËØçÈ°∫Â∫èÂèñËá™CET„ÄÇ
            </div>
        </div>

        <!-- Modals -->
        <div id="modal-pw" class="modal">
            <div class="modal-content">
                <h3 id="pw-title">ÂÆâÂÖ®È™åËØÅ</h3>
                <input type="password" id="pw-input" placeholder="ÁÆ°ÁêÜÂØÜÁ†Å" />
                <div class="btn-row">
                    <button
                        class="btn btn-gray"
                        onclick="closeModal('modal-pw')"
                    >
                        ÂèñÊ∂à
                    </button>
                    <button class="btn btn-primary" onclick="verifyAdmin()">
                        Á°ÆÂÆö
                    </button>
                </div>
            </div>
        </div>

        <div id="modal-checkin" class="modal">
            <div class="modal-content">
                <h2
                    id="checkin-word"
                    style="color: var(--primary-color); margin: 0"
                ></h2>
                <p
                    id="checkin-msg"
                    style="font-size: 14px; color: #666; margin: 15px 0"
                ></p>
                <div class="btn-row">
                    <button
                        class="btn btn-gray"
                        onclick="closeModal('modal-checkin')"
                    >
                        ÂèñÊ∂à
                    </button>
                    <button class="btn btn-primary" onclick="confirmCheckIn()">
                        Á°ÆËÆ§Á≠æÂà∞
                    </button>
                </div>
            </div>
        </div>

        <div id="modal-reward" class="modal">
            <div class="modal-content">
                <h3>ËÆæÁΩÆÂ•ñÂä±</h3>
                <input type="text" id="reward-input" placeholder="Â•ñÂä±ÂêçÁß∞" />
                <div class="btn-row">
                    <button
                        class="btn btn-gray"
                        onclick="closeModal('modal-reward')"
                    >
                        ÂèñÊ∂à
                    </button>
                    <button class="btn btn-primary" onclick="saveReward()">
                        ‰øùÂ≠ò
                    </button>
                </div>
            </div>
        </div>

        <div id="modal-sys" class="modal">
            <div class="modal-content">
                <h3>Âë®ÊúüÂ•ñÈÖçÁΩÆ</h3>
                <input type="number" id="sys-interval" placeholder="Âë®ÊúüÂ§©Êï∞" />
                <input type="text" id="sys-content" placeholder="Â•ñÂìÅÊèèËø∞" />
                <div class="btn-row">
                    <button
                        class="btn btn-gray"
                        onclick="closeModal('modal-sys')"
                    >
                        ÂèñÊ∂à
                    </button>
                    <button class="btn btn-primary" onclick="saveSysConfig()">
                        ‰øùÂ≠ò
                    </button>
                </div>
            </div>
        </div>

        <div id="modal-show-reward" class="modal">
            <div class="modal-content">
                <h3>üéâ ÊÅ≠ÂñúËé∑Âæó</h3>
                <div
                    id="show-reward-text"
                    style="
                        font-size: 20px;
                        color: #ff7675;
                        font-weight: bold;
                        margin: 20px 0;
                    "
                ></div>
                <div id="admin-edit-area"></div>
                <button
                    class="btn btn-primary"
                    style="width: 100%"
                    onclick="closeModal('modal-show-reward')"
                >
                    Êî∂‰∏ã‰∫Ü
                </button>
            </div>
        </div>

        <script>
            const CET_LIST = [
                { en: "Abandon", cn: "ÊîæÂºÉ" },
                { en: "Ability", cn: "ËÉΩÂäõ" },
                { en: "Abolish", cn: "Â∫üÈô§" },
                { en: "Abstract", cn: "ÊäΩË±°" },
                { en: "Abundant", cn: "‰∏∞ÂØåÁöÑ" },
                { en: "Academic", cn: "Â≠¶ÊúØÁöÑ" },
                { en: "Accelerate", cn: "Âä†ÈÄü" },
                { en: "Access", cn: "ÂÖ•Âè£" },
                { en: "Accompany", cn: "Èô™‰º¥" },
                { en: "Accomplish", cn: "ÂÆåÊàê" },
                { en: "Accurate", cn: "ÂáÜÁ°ÆÁöÑ" },
                { en: "Achieve", cn: "ËææÂà∞" },
                { en: "Acknowledge", cn: "ÊâøËÆ§" },
                { en: "Acquire", cn: "Ëé∑Âæó" },
                { en: "Adapt", cn: "ÈÄÇÂ∫î" },
                { en: "Adequate", cn: "ÂÖÖË∂≥" },
                { en: "Adjust", cn: "Ë∞ÉÊï¥" },
                { en: "Adopt", cn: "ÈááÁî®" },
                { en: "Advocate", cn: "ÊèêÂÄ°" },
                { en: "Affect", cn: "ÂΩ±Âìç" },
                { en: "Allocate", cn: "ÂàÜÈÖç" },
                { en: "Alter", cn: "ÊîπÂèò" },
                { en: "Alternative", cn: "ÈÄâÊã©" },
                { en: "Analyze", cn: "ÂàÜÊûê" },
                { en: "Annual", cn: "Âπ¥Â∫¶ÁöÑ" },
                { en: "Apparent", cn: "ÊòéÊòæÁöÑ" },
                { en: "Appreciate", cn: "Ê¨£Ëµè" },
                { en: "Appropriate", cn: "ÈÄÇÂΩì" },
                { en: "Aspect", cn: "ÊñπÈù¢" },
                { en: "Assess", cn: "ËØÑ‰º∞" },
                { en: "Assign", cn: "ÂàÜÈÖç" },
                { en: "Assist", cn: "ÂçèÂä©" },
                { en: "Assume", cn: "ÂÅáËÆæ" },
                { en: "Assure", cn: "‰øùËØÅ" },
                { en: "Attach", cn: "ÈôÑÁùÄ" },
                { en: "Attain", cn: "Ëé∑Âæó" },
                { en: "Attitude", cn: "ÊÄÅÂ∫¶" },
                { en: "Attribute", cn: "Â±ûÊÄß" },
                { en: "Authority", cn: "ÊùÉÂ®Å" },
                { en: "Available", cn: "ÂèØÁî®" },
                { en: "Benefit", cn: "Âà©Áõä" },
                { en: "Brief", cn: "ÁÆÄÁü≠" },
                { en: "Capable", cn: "ÊúâËÉΩÂäõ" },
                { en: "Capacity", cn: "ÂÆπÈáè" },
                { en: "Category", cn: "Á±ªÂà´" },
                { en: "Cease", cn: "ÂÅúÊ≠¢" },
                { en: "Challenge", cn: "ÊåëÊàò" },
                { en: "Channel", cn: "È¢ëÈÅì" },
                { en: "Civil", cn: "ÂÖ¨Ê∞ë" },
                { en: "Clarify", cn: "ÊæÑÊ∏Ö" },
                { en: "Classic", cn: "ÁªèÂÖ∏" },
                { en: "Code", cn: "‰ª£Á†Å" },
                { en: "Combine", cn: "ÁªìÂêà" },
                { en: "Comment", cn: "ËØÑËÆ∫" },
                { en: "Commit", cn: "Êèê‰∫§" },
                { en: "Communicate", cn: "Ê≤üÈÄö" },
                { en: "Complex", cn: "Â§çÊùÇ" },
                { en: "Component", cn: "ÁªÑ‰ª∂" },
                { en: "Concept", cn: "Ê¶ÇÂøµ" },
                { en: "Conclude", cn: "ÁªìËÆ∫" },
                { en: "Conduct", cn: "ÂºïÂØº" },
                { en: "Confirm", cn: "Á°ÆËÆ§" },
                { en: "Conflict", cn: "ÂÜ≤Á™Å" },
                { en: "Consent", cn: "ÂêåÊÑè" },
                { en: "Constant", cn: "ÊÅíÂÆö" },
                { en: "Construct", cn: "Âª∫ÈÄ†" },
                { en: "Consult", cn: "Âí®ËØ¢" },
                { en: "Consume", cn: "Ê∂àËÄó" },
                { en: "Contact", cn: "Êé•Ëß¶" },
                { en: "Context", cn: "‰∏ä‰∏ãÊñá" },
                { en: "Contract", cn: "ÂêàÂêå" },
                { en: "Contrast", cn: "ÂØπÊØî" },
                { en: "Convert", cn: "ËΩ¨Êç¢" },
                { en: "Convince", cn: "ËØ¥Êúç" },
                { en: "Core", cn: "Ê†∏ÂøÉ" },
                { en: "Corporate", cn: "Ê≥ï‰∫∫" },
                { en: "Create", cn: "ÂàõÈÄ†" },
                { en: "Credit", cn: "‰ø°Áî®" },
                { en: "Culture", cn: "ÊñáÂåñ" },
                { en: "Cycle", cn: "Âë®Êúü" },
                { en: "Data", cn: "Êï∞ÊçÆ" },
                { en: "Debate", cn: "Ëæ©ËÆ∫" },
                { en: "Decline", cn: "‰∏ãÈôç" },
                { en: "Define", cn: "ÂÆö‰πâ" },
                { en: "Design", cn: "ËÆæËÆ°" },
                { en: "Detect", cn: "Ê£ÄÊµã" },
                { en: "Device", cn: "ËÆæÂ§á" },
                { en: "Display", cn: "ÊòæÁ§∫" },
                { en: "Diverse", cn: "Â§öÊ†∑" },
                { en: "Domain", cn: "È¢ÜÂüü" },
                { en: "Domestic", cn: "ÂõΩÂÜÖ" },
                { en: "Draft", cn: "ËçâÊ°à" },
                { en: "Drama", cn: "ÊàèÂâß" },
                { en: "Dynamic", cn: "Âä®ÊÄÅ" },
                { en: "Economy", cn: "ÁªèÊµé" },
                { en: "Element", cn: "ÂÖÉÁ¥†" },
                { en: "Eliminate", cn: "Ê∂àÈô§" },
                { en: "Emerge", cn: "Âá∫Áé∞" },
                { en: "Emphasis", cn: "Âº∫Ë∞É" },
                { en: "Enable", cn: "ÂêØÁî®" },
                { en: "Energy", cn: "ËÉΩÈáè" },
                { en: "Enhance", cn: "Â¢ûÂº∫" },
                { en: "Ensure", cn: "Á°Æ‰øù" },
                { en: "Entity", cn: "ÂÆû‰Ωì" },
                { en: "Error", cn: "ÈîôËØØ" },
                { en: "Establish", cn: "Âª∫Á´ã" },
                { en: "Estate", cn: "ËµÑ‰∫ß" },
                { en: "Estimate", cn: "‰º∞ËÆ°" },
                { en: "Ethic", cn: "‰º¶ÁêÜ" },
                { en: "Evaluate", cn: "ËØÑ‰ª∑" },
                { en: "Eventual", cn: "ÊúÄÁªà" },
                { en: "Evident", cn: "ÊòæÁÑ∂" },
                { en: "Exceed", cn: "Ë∂ÖËøá" },
                { en: "Exclude", cn: "ÊéíÈô§" },
                { en: "Exhibit", cn: "Â±ïËßà" },
                { en: "Expand", cn: "Êâ©Âº†" },
                { en: "Expert", cn: "‰∏ìÂÆ∂" },
                { en: "Explicit", cn: "ÊòéÁ°Æ" },
                { en: "Export", cn: "Âá∫Âè£" },
                { en: "Expose", cn: "Êö¥Èú≤" },
                { en: "External", cn: "Â§ñÈÉ®" },
                { en: "Factor", cn: "Âõ†Á¥†" },
                { en: "Feature", cn: "ÁâπÂæÅ" },
                { en: "Finance", cn: "ÈáëËûç" },
                { en: "Final", cn: "ÊúÄÂêé" },
                { en: "Flexible", cn: "ÁÅµÊ¥ª" },
                { en: "Focus", cn: "ÁÑ¶ÁÇπ" },
                { en: "Format", cn: "Ê†ºÂºè" },
                { en: "Formula", cn: "ÂÖ¨Âºè" },
                { en: "Function", cn: "ÂäüËÉΩ" },
                { en: "Fund", cn: "Âü∫Èáë" },
                { en: "Gender", cn: "ÊÄßÂà´" },
                { en: "Generate", cn: "ÁîüÊàê" },
                { en: "Globe", cn: "ÂÖ®ÁêÉ" },
                { en: "Goal", cn: "ÁõÆÊ†á" },
                { en: "Grant", cn: "Êéà‰∫à" },
                { en: "Identify", cn: "Èâ¥ÂÆö" },
                { en: "Image", cn: "ÂΩ¢Ë±°" },
                { en: "Impact", cn: "ÂΩ±Âìç" },
                { en: "Imply", cn: "ÊöóÁ§∫" },
                { en: "Index", cn: "Á¥¢Âºï" },
                { en: "Indicate", cn: "ÊåáÂá∫" },
                { en: "Initial", cn: "ÊúÄÂàù" },
                { en: "Input", cn: "ËæìÂÖ•" },
                { en: "Insert", cn: "ÊèíÂÖ•" },
                { en: "Insight", cn: "ËßÅËß£" },
                { en: "Inspect", cn: "ËßÜÂØü" },
                { en: "Instance", cn: "‰æãÂ≠ê" },
                { en: "Integrate", cn: "Êï¥Âêà" },
                { en: "Internal", cn: "ÂÜÖÈÉ®" },
                { en: "Interpret", cn: "Ëß£Èáä" },
                { en: "Invest", cn: "ÊäïËµÑ" },
                { en: "Issue", cn: "ÂèëË°å" },
                { en: "Item", cn: "Êù°Ê¨æ" },
                { en: "Label", cn: "Ê†áÁ≠æ" },
                { en: "Legal", cn: "Ê≥ïÂæã" },
                { en: "Liberal", cn: "Ëá™Áî±" },
                { en: "Link", cn: "ÈìæÊé•" },
                { en: "Locate", cn: "ÂÆö‰Ωç" },
                { en: "Logic", cn: "ÈÄªËæë" },
                { en: "Maintain", cn: "Áª¥ÊåÅ" },
                { en: "Major", cn: "‰∏ªË¶Å" },
                { en: "Manual", cn: "ÊâãÂÜå" },
                { en: "Margin", cn: "ËæπÁºò" },
                { en: "Medical", cn: "ÂåªÁñó" },
                { en: "Medium", cn: "‰∏≠Á≠â" },
                { en: "Mental", cn: "ÂøÉÁêÜ" },
                { en: "Method", cn: "ÊñπÊ≥ï" },
                { en: "Modify", cn: "‰øÆÊîπ" },
                { en: "Monitor", cn: "ÁõëËßÜ" },
                { en: "Mutual", cn: "Áõ∏‰∫í" },
                { en: "Network", cn: "ÁΩëÁªú" },
                { en: "Neutral", cn: "‰∏≠Á´ã" },
                { en: "Normal", cn: "Ê≠£Â∏∏" },
                { en: "Notion", cn: "ÊÉ≥Ê≥ï" },
                { en: "Nuclear", cn: "Ê†∏ÂøÉ" },
                { en: "Objective", cn: "ÂÆ¢ËßÇ" },
                { en: "Obvious", cn: "ÊòéÊòæ" },
                { en: "Option", cn: "ÈÄâÈ°π" },
                { en: "Output", cn: "ËæìÂá∫" },
                { en: "Overall", cn: "ÂÖ®ÈÉ®" },
                { en: "Overlap", cn: "ÈáçÂè†" },
                { en: "Partner", cn: "‰º¥‰æ£" },
                { en: "Passive", cn: "Ë¢´Âä®" },
                { en: "Period", cn: "Èò∂ÊÆµ" },
                { en: "Persist", cn: "ÂùöÊåÅ" },
                { en: "Phase", cn: "Êó∂Êúü" },
                { en: "Policy", cn: "ÊîøÁ≠ñ" },
                { en: "Positive", cn: "ÁßØÊûÅ" },
                { en: "Potential", cn: "ÊΩúÂäõ" },
                { en: "Predict", cn: "È¢ÑÊµã" },
                { en: "Previous", cn: "‰ª•Ââç" },
                { en: "Primary", cn: "È¶ñË¶Å" },
                { en: "Principle", cn: "ÂéüÂàô" },
                { en: "Proceed", cn: "ËøõË°å" },
                { en: "Process", cn: "ËøáÁ®ã" },
                { en: "Project", cn: "ËÆ°Âàí" },
                { en: "Promote", cn: "‰øÉËøõ" },
                { en: "Purchase", cn: "Ë¥≠‰π∞" },
                { en: "Pursue", cn: "ËøΩËµ∂" },
                { en: "Random", cn: "ÈöèÊú∫" },
                { en: "Range", cn: "ËåÉÂõ¥" },
                { en: "Ratio", cn: "ÊØîÁéá" },
                { en: "Rational", cn: "ÁêÜÊÄß" },
                { en: "React", cn: "ÂèçÂ∫î" },
                { en: "Recover", cn: "ÊÅ¢Â§ç" },
                { en: "Region", cn: "Âú∞Âå∫" },
                { en: "Reject", cn: "ÊãíÁªù" },
                { en: "Release", cn: "ÈáäÊîæ" },
                { en: "Relevant", cn: "Áõ∏ÂÖ≥" },
                { en: "Rely", cn: "‰æùÈù†" },
                { en: "Remove", cn: "ÁßªÈô§" },
                { en: "Require", cn: "Ë¶ÅÊ±Ç" },
                { en: "Research", cn: "Á†îÁ©∂" },
                { en: "Resolve", cn: "Ëß£ÂÜ≥" },
                { en: "Resource", cn: "ËµÑÊ∫ê" },
                { en: "Respond", cn: "ÂõûÁ≠î" },
                { en: "Restore", cn: "‰øÆÂ§ç" },
                { en: "Reveal", cn: "Êè≠Èú≤" },
                { en: "Reverse", cn: "ÂÄíËΩ¨" },
                { en: "Review", cn: "Â§ç‰π†" },
                { en: "Role", cn: "ËßíËâ≤" },
                { en: "Route", cn: "Ë∑ØÁ∫ø" },
                { en: "Schedule", cn: "Êó•Á®ã" },
                { en: "Scheme", cn: "ÊñπÊ°à" },
                { en: "Scope", cn: "ËåÉÂõ¥" },
                { en: "Section", cn: "ÈÉ®ÂàÜ" },
                { en: "Sector", cn: "ÊâáÂå∫" },
                { en: "Secure", cn: "ÂÆâÂÖ®" },
                { en: "Seek", cn: "ÂØªÊ±Ç" },
                { en: "Select", cn: "ÈÄâÊã©" },
                { en: "Series", cn: "Á≥ªÂàó" },
                { en: "Shift", cn: "ËΩ¨Êç¢" },
                { en: "Signal", cn: "‰ø°Âè∑" },
                { en: "Similar", cn: "Áõ∏‰ºº" },
                { en: "Site", cn: "Âú∞ÁÇπ" },
                { en: "Source", cn: "Êù•Ê∫ê" },
                { en: "Specific", cn: "ÁâπÂÆö" },
                { en: "Status", cn: "Áä∂ÊÄÅ" },
                { en: "Stress", cn: "ÂéãÂäõ" },
                { en: "Style", cn: "È£éÊ†º" },
                { en: "Submit", cn: "Êèê‰∫§" },
                { en: "Summary", cn: "ÊëòË¶Å" },
                { en: "Survey", cn: "Ë∞ÉÊü•" },
                { en: "Symbol", cn: "Á¨¶Âè∑" },
                { en: "Target", cn: "ÁõÆÊ†á" },
                { en: "Task", cn: "‰ªªÂä°" },
                { en: "Team", cn: "Âõ¢Èòü" },
                { en: "Theory", cn: "ÁêÜËÆ∫" },
                { en: "Topic", cn: "ËØùÈ¢ò" },
                { en: "Trace", cn: "Ë∏™Ëøπ" },
                { en: "Transfer", cn: "ËΩ¨ËÆ©" },
                { en: "Trend", cn: "Ë∂ãÂäø" },
                { en: "Trigger", cn: "Ëß¶Âèë" },
                { en: "Unique", cn: "Áã¨Áâπ" },
                { en: "Unit", cn: "ÂçïÂÖÉ" },
                { en: "Valid", cn: "ÊúâÊïà" },
                { en: "Vary", cn: "ÂèòÂåñ" },
                { en: "Vehicle", cn: "ËΩ¶ËæÜ" },
                { en: "Version", cn: "ÁâàÊú¨" },
                { en: "Via", cn: "ÁªèÁî±" },
                { en: "Virtual", cn: "ËôöÊãü" },
                { en: "Visible", cn: "ÂèØËßÅ" },
                { en: "Vision", cn: "ËøúËßÅ" },
                { en: "Visual", cn: "ËßÜËßâ" },
                { en: "Volume", cn: "Èü≥Èáè" },
            ];

            let viewDate = new Date();
            let checkins = JSON.parse(
                localStorage.getItem("cal_checkins") || "[]",
            );
            let rewards = JSON.parse(
                localStorage.getItem("cal_rewards") || "{}",
            );
            let wordMap = JSON.parse(
                localStorage.getItem("cal_word_map") || "{}",
            );
            let cetPointer = parseInt(
                localStorage.getItem("cal_cet_ptr") || "0",
            );
            let sysRewardConfig = JSON.parse(
                localStorage.getItem("cal_sys_reward") ||
                    '{"interval": 7, "content": "Âë®ÊúüÊÄßÊàêÂ∞±Â•ñ"}',
            );
            let adminPassword = localStorage.getItem("cal_pw") || "";
            let pendingDate = "",
                passwordActionType = "";

            const LUNAR_MAP = [
                "Âàù‰∏Ä",
                "Âàù‰∫å",
                "Âàù‰∏â",
                "ÂàùÂõõ",
                "Âàù‰∫î",
                "ÂàùÂÖ≠",
                "Âàù‰∏É",
                "ÂàùÂÖ´",
                "Âàù‰πù",
                "ÂàùÂçÅ",
                "ÂçÅ‰∏Ä",
                "ÂçÅ‰∫å",
                "ÂçÅ‰∏â",
                "ÂçÅÂõõ",
                "ÂçÅ‰∫î",
                "ÂçÅÂÖ≠",
                "ÂçÅ‰∏É",
                "ÂçÅÂÖ´",
                "ÂçÅ‰πù",
                "‰∫åÂçÅ",
                "Âªø‰∏Ä",
                "Âªø‰∫å",
                "Âªø‰∏â",
                "ÂªøÂõõ",
                "Âªø‰∫î",
                "ÂªøÂÖ≠",
                "Âªø‰∏É",
                "ÂªøÂÖ´",
                "Âªø‰πù",
                "‰∏âÂçÅ",
            ];

            function getWordForDate(ds) {
                if (wordMap[ds]) return wordMap[ds];
                const word = CET_LIST[cetPointer % CET_LIST.length];
                wordMap[ds] = word;
                cetPointer++;
                localStorage.setItem("cal_word_map", JSON.stringify(wordMap));
                localStorage.setItem("cal_cet_ptr", cetPointer.toString());
                return word;
            }

            function getLunar(ds) {
                try {
                    const dt = new Date(ds);
                    const lunarStr = new Intl.DateTimeFormat(
                        "zh-CN-u-ca-chinese",
                        { day: "numeric" },
                    ).format(dt);
                    const dayNum = parseInt(lunarStr.replace(/[^0-9]/g, ""));
                    if (!isNaN(dayNum) && dayNum >= 1 && dayNum <= 30)
                        return LUNAR_MAP[dayNum - 1];
                    return lunarStr.replace(/Êó•$/, "");
                } catch (e) {
                    return "";
                }
            }

            function render() {
                const grid = document.getElementById("calendar-grid");
                const display = document.getElementById("month-display");
                const headers = Array.from(grid.querySelectorAll(".weekday"));
                grid.innerHTML = "";
                headers.forEach((h) => grid.appendChild(h));

                const y = viewDate.getFullYear(),
                    m = viewDate.getMonth();
                display.innerText = `${y}Âπ¥ ${m + 1}Êúà`;

                const firstDay = new Date(y, m, 1).getDay();
                const lastDate = new Date(y, m + 1, 0).getDate();
                const prevLast = new Date(y, m, 0).getDate();

                const sortedCheckins = [...checkins].sort();
                const sysRewardDates = [];
                let vCount = 0;
                sortedCheckins.forEach((d) => {
                    if (!rewards[d]) {
                        vCount++;
                        if (vCount % sysRewardConfig.interval === 0)
                            sysRewardDates.push(d);
                    }
                });

                for (let i = firstDay; i > 0; i--)
                    grid.appendChild(createCell(prevLast - i + 1, true));
                for (let d = 1; d <= lastDate; d++) {
                    const ds = `${y}-${String(m + 1).padStart(2, "0")}-${String(d).padStart(2, "0")}`;
                    grid.appendChild(
                        createCell(d, false, ds, sysRewardDates.includes(ds)),
                    );
                }
            }

            function createCell(num, isOther, ds, isSys) {
                const div = document.createElement("div");
                div.className = "day" + (isOther ? " other-month" : "");
                if (isOther) {
                    div.innerHTML = `<span style="font-size:10px;color:#ccc">${num}</span>`;
                    return div;
                }

                const todayStr = new Date().toLocaleDateString("en-CA");
                if (ds === todayStr) div.classList.add("today");
                if (checkins.includes(ds)) div.classList.add("checked-in");

                const word = getWordForDate(ds);
                const lunar = getLunar(ds);

                div.innerHTML = `
                <div class="day-header"><div class="day-num">${num}</div><div class="lunar">${lunar}</div></div>
                <img class="day-img" src="https://picsum.photos/seed/${ds}/80/80" ondblclick="event.stopPropagation(); openAdmin('reward','${ds}')">
                <div class="word-wrap">
                    <div class="en-word" style="font-size:${word.en.length > 12 ? "9px" : "11px"}">${word.en}</div>
                    <div class="cn-word">${word.cn}</div>
                    <button class="audio-btn" onclick="event.stopPropagation(); speak('${word.en}')">üîä</button>
                </div>`;

                if (checkins.includes(ds))
                    div.insertAdjacentHTML(
                        "beforeend",
                        '<span class="check-mark">‚úì</span>',
                    );
                if (rewards[ds])
                    div.insertAdjacentHTML(
                        "beforeend",
                        `<span class="badge-reward" onclick="event.stopPropagation(); showRewardInfo('${ds}',false)">üéÅ</span>`,
                    );
                if (isSys) {
                    div.insertAdjacentHTML(
                        "afterbegin",
                        '<div class="sys-tag">Âë®ÊúüÂ•ñ</div>',
                    );
                    div.insertAdjacentHTML(
                        "beforeend",
                        `<span class="badge-sys" onclick="event.stopPropagation(); showRewardInfo('${ds}',true)">üèÜ</span>`,
                    );
                }

                let timer = null;
                div.onclick = () => {
                    if (timer) {
                        clearTimeout(timer);
                        timer = null;
                        openAdmin("reset", ds);
                    } else {
                        timer = setTimeout(() => {
                            timer = null;
                            handleCellClick(ds, word);
                        }, 250);
                    }
                };
                return div;
            }

            function handleCellClick(ds, word) {
                const today = new Date().toLocaleDateString("en-CA");
                if (checkins.includes(ds) || ds > today) {
                    speak(word.en);
                    if (checkins.includes(ds)) return;
                }
                if (ds > today) return;
                pendingDate = ds;
                const remain =
                    sysRewardConfig.interval -
                    (checkins.length % sysRewardConfig.interval);
                document.getElementById("checkin-word").innerText = word.en;
                document.getElementById("checkin-msg").innerText =
                    `Á°ÆËÆ§Á≠æÂà∞ÂêóÔºüË∑ùÁ¶ª‰∏ã‰∏™Âë®ÊúüÂ•ñËøòÈúÄ ${remain} Â§©„ÄÇ`;
                openModal("modal-checkin");
            }

            function confirmCheckIn() {
                if (!checkins.includes(pendingDate)) {
                    checkins.push(pendingDate);
                    checkins.sort();
                    localStorage.setItem(
                        "cal_checkins",
                        JSON.stringify(checkins),
                    );
                }
                closeModal("modal-checkin");
                render();
            }

            function openAdmin(type, ds) {
                pendingDate = ds || "";
                passwordActionType = type;
                document.getElementById("pw-title").innerText = adminPassword
                    ? "Ë∫´‰ªΩÈ™åËØÅ"
                    : "ËÆæÁΩÆÁÆ°ÁêÜÂØÜÁ†Å";
                openModal("modal-pw");
            }

            function verifyAdmin() {
                const val = document.getElementById("pw-input").value;
                if (!adminPassword) {
                    if (val.length < 4) return alert("ÂØÜÁ†ÅËá≥Â∞ë4‰Ωç");
                    adminPassword = val;
                    localStorage.setItem("cal_pw", val);
                } else if (val !== adminPassword) return alert("ÂØÜÁ†ÅÈîôËØØ");
                closeModal("modal-pw");
                document.getElementById("pw-input").value = "";
                if (passwordActionType === "reward") {
                    document.getElementById("reward-input").value =
                        rewards[pendingDate] || "";
                    openModal("modal-reward");
                } else if (passwordActionType === "sys_config") {
                    document.getElementById("sys-interval").value =
                        sysRewardConfig.interval;
                    document.getElementById("sys-content").value =
                        sysRewardConfig.content;
                    openModal("modal-sys");
                } else if (passwordActionType === "reset") {
                    checkins = checkins.filter((d) => d !== pendingDate);
                    localStorage.setItem(
                        "cal_checkins",
                        JSON.stringify(checkins),
                    );
                    render();
                }
            }

            function saveReward() {
                const val = document
                    .getElementById("reward-input")
                    .value.trim();
                if (val) rewards[pendingDate] = val;
                else delete rewards[pendingDate];
                localStorage.setItem("cal_rewards", JSON.stringify(rewards));
                closeModal("modal-reward");
                render();
            }

            function saveSysConfig() {
                const i = parseInt(
                    document.getElementById("sys-interval").value,
                );
                const c = document.getElementById("sys-content").value.trim();
                if (isNaN(i) || i < 1) return alert("Êó†ÊïàÂë®Êúü");
                sysRewardConfig = { interval: i, content: c };
                localStorage.setItem(
                    "cal_sys_reward",
                    JSON.stringify(sysRewardConfig),
                );
                closeModal("modal-sys");
                render();
            }

            function showRewardInfo(ds, isSys) {
                if (!checkins.includes(ds)) return alert("ËØ∑ÂÖàÁ≠æÂà∞");
                const text = isSys ? sysRewardConfig.content : rewards[ds];
                document.getElementById("show-reward-text").innerText = text;
                const area = document.getElementById("admin-edit-area");
                area.innerHTML = "";
                if (adminPassword) {
                    const b = document.createElement("button");
                    b.className = "btn btn-primary";
                    b.style.width = "100%";
                    b.style.marginBottom = "10px";
                    b.innerText = isSys ? "‰øÆÊîπÁ≥ªÁªüÂ•ñ" : "‰øÆÊîπÊâãÂä®Â•ñ";
                    b.onclick = () => {
                        closeModal("modal-show-reward");
                        openAdmin(isSys ? "sys_config" : "reward", ds);
                    };
                    area.appendChild(b);
                }
                openModal("modal-show-reward");
            }

            function speak(text) {
                if (!text || !("speechSynthesis" in window)) return;
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text);
                u.lang = "en-US";
                u.rate = 0.9;
                window.speechSynthesis.speak(u);
            }

            function changeMonth(step) {
                viewDate.setMonth(viewDate.getMonth() + step);
                render();
            }
            function openModal(id) {
                document.getElementById(id).style.display = "flex";
            }
            function closeModal(id) {
                document.getElementById(id).style.display = "none";
            }

            render();
        </script>
    </body>
</html>
